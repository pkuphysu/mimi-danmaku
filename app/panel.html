<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mimi Danmaku Panel</title>
<link rel="stylesheet" href="../node_modules/bootstrap/dist/css/bootstrap.min.css">
<style>
.container {
	margin: 20px;
	max-width: calc(100% - 40px);
}
</style>
</head>
<body>
<div class="container g-0">
	<h1>Mimi Danmaku</h1>
	<p id="help">欢迎使用米米弹幕</p>

	<div class="mb-3">
		<label class="form-label fw-bold">显示模式</label>
		<div class="btn-group" role="group">
			<button type="button" class="btn btn-outline-secondary active" data-help="弹幕窗口将在全屏幕上浮动显示">固定(全屏幕)</button>
			<button type="button" class="btn btn-outline-secondary" data-help="弹幕窗口将以窗口形式显示">窗口(可移动)</button>
		</div>
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">窗口叠放</label>
		<div class="btn-group" role="group">
			<button type="button" class="btn btn-outline-secondary active" data-help="窗口将始终处于屏幕顶层，即使存在其他全屏应用">始终置顶</button>
			<button type="button" class="btn btn-outline-secondary" data-help="使用其他全屏应用时，弹幕窗口可能不会置顶">优先置顶</button>
		</div>
	</div>

	<div class="mb-3" style="display: none;">
		<label class="form-label fw-bold">背景图片</label>
		<div class="btn-group" role="group">
			<button type="button" class="btn btn-outline-secondary active" data-help="弹幕窗口背景透明">透明背景</button>
			<button type="button" class="btn btn-outline-secondary" data-help="弹幕窗口使用系统预设背景">默认图片</button>
		</div>
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">弹幕过滤</label>
		<div class="btn-group" role="group">
			<button type="button" class="btn btn-outline-secondary active" data-help="弹幕按照规则自动过滤">自动过滤</button>
			<button type="button" class="btn btn-outline-secondary" data-help="默认允许所有弹幕">默认允许</button>
			<button type="button" class="btn btn-outline-secondary" data-help="默认禁止所有弹幕">默认禁止</button>
		</div>
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">过滤模式</label>
		<div class="btn-group" role="group">
			<button type="button" class="btn btn-outline-secondary active" data-help="含有屏蔽词的弹幕直接禁止">直接禁止</button>
			<button type="button" class="btn btn-outline-secondary" data-help="替换屏蔽词为*">替换内容</button>
		</div>
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">过滤规则<span class="text-muted">（屏蔽词，使用空格分隔，不支持正则）</span></label>
		<textarea class="form-control" rows="3" id="rule" style="resize: none;"></textarea>
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">客户端</label>
		<input type="text" class="form-control" placeholder="" id="client">
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">服务端</label>
		<input type="text" class="form-control" placeholder="" id="server">
	</div>

	<div class="mb-3">
		<label class="form-label fw-bold">弹幕频道</label>
		<input type="text" class="form-control" placeholder="default" id="channel">
	</div>

	<div class="flex-column">
		<div class="mb-3">
			<button class="btn btn-success" onclick="MimiDanmaku.ws.wsreload()">连接弹幕频道</button>
			<button class="btn btn-primary" onclick="MimiDanmaku.panelSubmit()" id="submit">开启弹幕窗口</button>
			<button class="btn btn-secondary" onclick="MimiDanmaku.about()">关于</button>
		</div>
		<div class="mb-3">
			<button class="btn btn-primary" onclick="MimiDanmaku.danmaku.clearAll()">清空弹幕列表</button>
			<button class="btn btn-danger" onclick="MimiDanmaku.danmaku.denyAll()" id="submit">撤回所有弹幕</button>
		</div>
		<table class="table table-striped" style="table-layout: fixed;">
			<thead>
				<tr>
					<th>弹幕内容</th>
					<th style="width: 160px;">审核</th>
				</tr>
			</thead>
			<tbody>
				<tr>
					<td>欢迎使用米米弹幕</td>
					<td>
						<div class="btn-group" role="group">
							<button type="button" class="btn btn-success disabled">已通过</button>
							<button type="button" class="btn btn-danger disabled">禁止</button>
						</div>
					</td>
				</tr>
			</tbody>
		</table>
	</div>
</div>

<script>
const { ipcRenderer } = require("electron");
const webSocketController = require("./js/wsconnect");
const danmakuController = require("./js/harmony");
const { panelSubmit } = require("./js/settings");
const { about } = require("./js/utils");

const MimiDanmaku = {
	ws: webSocketController,
	danmaku: danmakuController,
	panelSubmit,
	about
};

ipcRenderer.on("denyall", () => {
	MimiDanmaku.danmaku.denyAll();
});
</script>
</body>
</html>
